<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Other functionalities | dispRity manual</title>
  <meta name="description" content="dispRity R package vignette" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Other functionalities | dispRity manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="dispRity R package vignette" />
  <meta name="github-repo" content="TGuillerme/dispRity" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Other functionalities | dispRity manual" />
  
  <meta name="twitter:description" content="dispRity R package vignette" />
  

<meta name="author" content="Thomas Guillerme (guillert@tcd.ie), Mark Puttick (marknputtick@gmail.com) and Natalie Cooper (natalie.cooper@nhm.ac.uk)" />


<meta name="date" content="2020-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-stuff-up.html"/>
<link rel="next" href="the-guts-of-the-disprity-package.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">dispRity manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <code>dispRity</code></a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-disprity"><i class="fa fa-check"></i><b>1.1</b> What is <code>dispRity</code>?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#modular"><i class="fa fa-check"></i><b>1.1.1</b> Modular?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-and-running-the-package"><i class="fa fa-check"></i><b>1.2</b> Installing and running the package</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#version"><i class="fa fa-check"></i><b>1.3</b> Which version do I choose?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#citations"><i class="fa fa-check"></i><b>1.5</b> Citations</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#why-is-it-important-to-cite-us"><i class="fa fa-check"></i><b>1.5.1</b> Why is it important to cite us?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>2</b> Glossary</a><ul>
<li class="chapter" data-level="2.1" data-path="glossary.html"><a href="glossary.html#glossary-equivalences-in-palaeobiology-and-ecology"><i class="fa fa-check"></i><b>2.1</b> Glossary equivalences in palaeobiology and ecology</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html"><i class="fa fa-check"></i><b>3</b> Getting started with <code>dispRity</code></a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#what-sort-of-data-does-disprity-work-with"><i class="fa fa-check"></i><b>3.1</b> What sort of data does <code>dispRity</code> work with?</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#ordinated-matrices"><i class="fa fa-check"></i><b>3.2</b> Ordinated matrices</a><ul>
<li class="chapter" data-level="3.2.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#ordination-matrices-from-geomorph"><i class="fa fa-check"></i><b>3.2.1</b> Ordination matrices from <code>geomorph</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#Claddis-ordination"><i class="fa fa-check"></i><b>3.2.2</b> Ordination matrices from <code>Claddis</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#other-kinds-of-ordination-matrices"><i class="fa fa-check"></i><b>3.2.3</b> Other kinds of ordination matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#simpleanalysis"><i class="fa fa-check"></i><b>3.3</b> Performing a simple dispRity analysis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#example-data"><i class="fa fa-check"></i><b>3.3.1</b> Example data</a></li>
<li class="chapter" data-level="3.3.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#disparity-through-time"><i class="fa fa-check"></i><b>3.3.2</b> Disparity through time</a></li>
<li class="chapter" data-level="3.3.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#disparity-among-groups"><i class="fa fa-check"></i><b>3.3.3</b> Disparity among groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html"><i class="fa fa-check"></i><b>4</b> Details of specific functions</a><ul>
<li class="chapter" data-level="4.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#chrono-subsets"><i class="fa fa-check"></i><b>4.1</b> Time slicing</a><ul>
<li class="chapter" data-level="4.1.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#time-binning"><i class="fa fa-check"></i><b>4.1.1</b> Time-binning</a></li>
<li class="chapter" data-level="4.1.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#time-slicing"><i class="fa fa-check"></i><b>4.1.2</b> Time-slicing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#custom-subsets"><i class="fa fa-check"></i><b>4.2</b> Customised subsets</a></li>
<li class="chapter" data-level="4.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#bootstraps-and-rarefactions"><i class="fa fa-check"></i><b>4.3</b> Bootstraps and rarefactions</a></li>
<li class="chapter" data-level="4.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#disparity-metrics"><i class="fa fa-check"></i><b>4.4</b> Disparity metrics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#the-function-dimension-levels"><i class="fa fa-check"></i><b>4.4.1</b> The function dimension-levels</a></li>
<li class="chapter" data-level="4.4.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#betweengroupmetricsexplain"><i class="fa fa-check"></i><b>4.4.2</b> Between groups metrics</a></li>
<li class="chapter" data-level="4.4.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#makemetric"><i class="fa fa-check"></i><b>4.4.3</b> <code>make.metric</code></a></li>
<li class="chapter" data-level="4.4.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#metrics-in-the-disprity-function"><i class="fa fa-check"></i><b>4.4.4</b> Metrics in the <code>dispRity</code> function</a></li>
<li class="chapter" data-level="4.4.5" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#metrics-implemented-in-disprity"><i class="fa fa-check"></i><b>4.4.5</b> Metrics implemented in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#equations-and-implementations"><i class="fa fa-check"></i><b>4.4.6</b> Equations and implementations</a></li>
<li class="chapter" data-level="4.4.7" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#using-the-different-disparity-metrics"><i class="fa fa-check"></i><b>4.4.7</b> Using the different disparity metrics</a></li>
<li class="chapter" data-level="4.4.8" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#which-disparity-metric-to-choose"><i class="fa fa-check"></i><b>4.4.8</b> Which disparity metric to choose?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#summarising-disprity-data-plots"><i class="fa fa-check"></i><b>4.5</b> Summarising dispRity data (plots)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#summarising-disprity-data"><i class="fa fa-check"></i><b>4.5.1</b> Summarising <code>dispRity</code> data</a></li>
<li class="chapter" data-level="4.5.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#plotting-disprity-data"><i class="fa fa-check"></i><b>4.5.2</b> Plotting <code>dispRity</code> data</a></li>
<li class="chapter" data-level="4.5.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#type-preview"><i class="fa fa-check"></i><b>4.5.3</b> <code>type = preview</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#testing-disparity-hypotheses"><i class="fa fa-check"></i><b>4.6</b> Testing disparity hypotheses</a><ul>
<li class="chapter" data-level="4.6.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#adonis"><i class="fa fa-check"></i><b>4.6.1</b> NPMANOVA in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#dtt"><i class="fa fa-check"></i><b>4.6.2</b> <code>geiger::dtt</code> model fitting in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#null-test"><i class="fa fa-check"></i><b>4.6.3</b> null morphospace testing with <code>null.test</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#model-fitting"><i class="fa fa-check"></i><b>4.7</b> Fitting modes of evolution to disparity data</a><ul>
<li class="chapter" data-level="4.7.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#simple-modes-of-disparity-change-through-time"><i class="fa fa-check"></i><b>4.7.1</b> Simple modes of disparity change through time</a></li>
<li class="chapter" data-level="4.7.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#plot-and-run-simulation-tests-in-a-single-step"><i class="fa fa-check"></i><b>4.7.2</b> Plot and run simulation tests in a single step</a></li>
<li class="chapter" data-level="4.7.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#multiple-modes-of-evolution-time-shifts"><i class="fa fa-check"></i><b>4.7.3</b> Multiple modes of evolution (time shifts)</a></li>
<li class="chapter" data-level="4.7.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#model.test.sim"><i class="fa fa-check"></i><b>4.7.4</b> <code>model.test.sim</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#disparity-distribution"><i class="fa fa-check"></i><b>4.8</b> Disparity as a distribution</a></li>
<li class="chapter" data-level="4.9" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#other-matrices"><i class="fa fa-check"></i><b>4.9</b> Disparity from other matrices</a></li>
<li class="chapter" data-level="4.10" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#multi.input"><i class="fa fa-check"></i><b>4.10</b> Disparity from multiple matrices (and multiple trees!)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="making-stuff-up.html"><a href="making-stuff-up.html"><i class="fa fa-check"></i><b>5</b> Making stuff up!</a><ul>
<li class="chapter" data-level="5.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#simulating-discrete-morphological-data"><i class="fa fa-check"></i><b>5.1</b> Simulating discrete morphological data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#a-more-detailed-description"><i class="fa fa-check"></i><b>5.1.1</b> A more detailed description</a></li>
<li class="chapter" data-level="5.1.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#parameters-for-a-realisticish-matrix"><i class="fa fa-check"></i><b>5.1.2</b> Parameters for a realistic(ish) matrix</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#simulating-multidimensional-spaces"><i class="fa fa-check"></i><b>5.2</b> Simulating multidimensional spaces</a><ul>
<li class="chapter" data-level="5.2.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#personalised-dimensions-distributions"><i class="fa fa-check"></i><b>5.2.1</b> Personalised dimensions distributions</a></li>
<li class="chapter" data-level="5.2.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#visualising-the-space"><i class="fa fa-check"></i><b>5.2.2</b> Visualising the space</a></li>
<li class="chapter" data-level="5.2.3" data-path="making-stuff-up.html"><a href="making-stuff-up.html#generating-realistic-spaces"><i class="fa fa-check"></i><b>5.2.3</b> Generating realistic spaces</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="other-functionalities.html"><a href="other-functionalities.html"><i class="fa fa-check"></i><b>6</b> Other functionalities</a><ul>
<li class="chapter" data-level="6.1" data-path="other-functionalities.html"><a href="other-functionalities.html#char.diff"><i class="fa fa-check"></i><b>6.1</b> <code>char.diff</code></a></li>
<li class="chapter" data-level="6.2" data-path="other-functionalities.html"><a href="other-functionalities.html#clean.data"><i class="fa fa-check"></i><b>6.2</b> <code>clean.data</code></a></li>
<li class="chapter" data-level="6.3" data-path="other-functionalities.html"><a href="other-functionalities.html#crown.stem"><i class="fa fa-check"></i><b>6.3</b> <code>crown.stem</code></a></li>
<li class="chapter" data-level="6.4" data-path="other-functionalities.html"><a href="other-functionalities.html#get.bin.ages"><i class="fa fa-check"></i><b>6.4</b> <code>get.bin.ages</code></a></li>
<li class="chapter" data-level="6.5" data-path="other-functionalities.html"><a href="other-functionalities.html#pair.plot"><i class="fa fa-check"></i><b>6.5</b> <code>pair.plot</code></a></li>
<li class="chapter" data-level="6.6" data-path="other-functionalities.html"><a href="other-functionalities.html#reduce.matrix"><i class="fa fa-check"></i><b>6.6</b> <code>reduce.matrix</code></a></li>
<li class="chapter" data-level="6.7" data-path="other-functionalities.html"><a href="other-functionalities.html#slice.tree"><i class="fa fa-check"></i><b>6.7</b> <code>slice.tree</code></a></li>
<li class="chapter" data-level="6.8" data-path="other-functionalities.html"><a href="other-functionalities.html#slide.nodes-and-remove.zero.brlen"><i class="fa fa-check"></i><b>6.8</b> <code>slide.nodes</code> and <code>remove.zero.brlen</code></a></li>
<li class="chapter" data-level="6.9" data-path="other-functionalities.html"><a href="other-functionalities.html#tree.age"><i class="fa fa-check"></i><b>6.9</b> <code>tree.age</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html"><i class="fa fa-check"></i><b>7</b> The guts of the <code>dispRity</code> package</a><ul>
<li class="chapter" data-level="7.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#manipulating-disprity-objects"><i class="fa fa-check"></i><b>7.1</b> Manipulating <code>dispRity</code> objects</a></li>
<li class="chapter" data-level="7.2" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#utilities"><i class="fa fa-check"></i><b>7.2</b> <code>dispRity</code> utilities</a><ul>
<li class="chapter" data-level="7.2.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disprity-object-utilities"><i class="fa fa-check"></i><b>7.2.1</b> <code>dispRity</code> object utilities <a name="dispRity.utilities"></a></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disprity-object"><i class="fa fa-check"></i><b>7.3</b> The <code>dispRity</code> object content</a><ul>
<li class="chapter" data-level="7.3.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#matrix"><i class="fa fa-check"></i><b>7.3.1</b> <code>$matrix</code></a></li>
<li class="chapter" data-level="7.3.2" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#call"><i class="fa fa-check"></i><b>7.3.2</b> <code>$call</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#subsets"><i class="fa fa-check"></i><b>7.3.3</b> <code>$subsets</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disparity"><i class="fa fa-check"></i><b>7.3.4</b> <code>$disparity</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ecology-demo.html"><a href="ecology-demo.html"><i class="fa fa-check"></i><b>8</b> Ecology demo</a><ul>
<li class="chapter" data-level="8.1" data-path="ecology-demo.html"><a href="ecology-demo.html#data"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="ecology-demo.html"><a href="ecology-demo.html#classic-analysis"><i class="fa fa-check"></i><b>8.2</b> Classic analysis</a></li>
<li class="chapter" data-level="8.3" data-path="ecology-demo.html"><a href="ecology-demo.html#a-multidimensional-approach-with-disprity"><i class="fa fa-check"></i><b>8.3</b> A multidimensional approach with <code>dispRity</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="ecology-demo.html"><a href="ecology-demo.html#bootstrapping-the-data"><i class="fa fa-check"></i><b>8.3.1</b> Bootstrapping the data</a></li>
<li class="chapter" data-level="8.3.2" data-path="ecology-demo.html"><a href="ecology-demo.html#calculating-disparity"><i class="fa fa-check"></i><b>8.3.2</b> Calculating disparity</a></li>
<li class="chapter" data-level="8.3.3" data-path="ecology-demo.html"><a href="ecology-demo.html#summarising-the-results-plot"><i class="fa fa-check"></i><b>8.3.3</b> Summarising the results (plot)</a></li>
<li class="chapter" data-level="8.3.4" data-path="ecology-demo.html"><a href="ecology-demo.html#testing-hypothesis"><i class="fa fa-check"></i><b>8.3.4</b> Testing hypothesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html"><i class="fa fa-check"></i><b>9</b> Palaeobiology demo: disparity-through-time and within groups</a><ul>
<li class="chapter" data-level="9.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#before-starting"><i class="fa fa-check"></i><b>9.1</b> Before starting</a><ul>
<li class="chapter" data-level="9.1.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#the-morphospace"><i class="fa fa-check"></i><b>9.1.1</b> The morphospace</a></li>
<li class="chapter" data-level="9.1.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#setting-up-your-own-data"><i class="fa fa-check"></i><b>9.1.2</b> Setting up your own data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#a-disparity-through-time-analysis"><i class="fa fa-check"></i><b>9.2</b> A disparity-through-time analysis</a><ul>
<li class="chapter" data-level="9.2.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#splitting-the-morphospace-through-time"><i class="fa fa-check"></i><b>9.2.1</b> Splitting the morphospace through time</a></li>
<li class="chapter" data-level="9.2.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#bootstrapping-the-data-1"><i class="fa fa-check"></i><b>9.2.2</b> Bootstrapping the data</a></li>
<li class="chapter" data-level="9.2.3" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#calculating-disparity-1"><i class="fa fa-check"></i><b>9.2.3</b> Calculating disparity</a></li>
<li class="chapter" data-level="9.2.4" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#plotting-the-results"><i class="fa fa-check"></i><b>9.2.4</b> Plotting the results</a></li>
<li class="chapter" data-level="9.2.5" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#testing-differences"><i class="fa fa-check"></i><b>9.2.5</b> Testing differences</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#some-more-advanced-stuff"><i class="fa fa-check"></i><b>9.3</b> Some more advanced stuff</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html"><i class="fa fa-check"></i><b>10</b> Morphometric geometric demo: a between group analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#before-starting-1"><i class="fa fa-check"></i><b>10.1</b> Before starting</a><ul>
<li class="chapter" data-level="10.1.1" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#the-morphospace-1"><i class="fa fa-check"></i><b>10.1.1</b> The morphospace</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#calculating-disparity-2"><i class="fa fa-check"></i><b>10.2</b> Calculating disparity</a></li>
<li class="chapter" data-level="10.3" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#analyse-the-results"><i class="fa fa-check"></i><b>10.3</b> Analyse the results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/dispRity/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">dispRity manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="other-functionalities" class="section level1">
<h1><span class="header-section-number">6</span> Other functionalities</h1>
<p>The <code>dispRity</code> package also contains several other functions that are not specific to multidimensional analysis but that are often used by <code>dispRity</code> internal functions.
However, we decided to make these functions also available at a user level since they can be handy for certain specific operations!
You’ll find a brief description of each of them (alphabetically) here:</p>
<div id="char.diff" class="section level2">
<h2><span class="header-section-number">6.1</span> <code>char.diff</code></h2>
<p>This is yet another function for calculating distance matrices.
There are many functions for calculating pairwise distance matrices in <code>R</code> (<code>stats::dist</code>, <code>vegan::vegdist</code>, <code>cluster::daisy</code> or <code>Claddis::calculate_morphological_distances</code>) but this one is the <code>dispRity</code> one.
It is slightly different to the ones mentioned above (though not that dissimilar from <code>Claddis::calculate_morphological_distances</code>) in the fact that it focuses on comparing discrete morphological characters and tries to solve all the problems linked to these kind of matrices (especially dealing with special tokens).</p>
<p>The function intakes a matrix with either <code>numeric</code> or <code>integer</code> (<code>NA</code> included) or matrices with <code>character</code> that are indeed <code>integers</code> (e.g.<code>&quot;0&quot;</code> and <code>&quot;1&quot;</code>).
It then uses a <a href="https://en.wikipedia.org/wiki/Bitwise_operations_in_C">bitwise operations</a> architecture implemented in <code>C</code> that renders the function pretty fast and pretty modular.
This bitwise operations translates the character states into binary values.
This way, <code>0</code> becomes <code>1</code>, <code>1</code> becomes <code>2</code>, <code>2</code> becomes <code>4</code>, <code>3</code> becomes <code>8</code>, etc…
Specifically it can handle any rules specific to special tokens (i.e. symbols) for discrete morphological characters. For example, should you treat missing values <code>&quot;?&quot;</code> as <code>NA</code> (ignoring them) or as any possible character state (e.g. <code>c(&quot;0&quot;, &quot;1&quot;)</code>?)? And how to treat characters with a ampersand (<code>&quot;&amp;&quot;</code>)? <code>char.diff</code> can answer to all these questions!</p>
<p>Let’s start by a basic binary matrix 4*3 with random <code>integer</code>:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" data-line-number="1"><span class="co">## A random binary matrix</span></a>
<a class="sourceLine" id="cb420-2" data-line-number="2">matrix_binary &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">12</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">ncol =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb420-3" data-line-number="3">                        <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]))</a></code></pre></div>
<p>By default, <code>char.diff</code> measures the hamming distance between characters:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" data-line-number="1"><span class="co">## The hamming distance between characters</span></a>
<a class="sourceLine" id="cb421-2" data-line-number="2">(differences &lt;-<span class="st"> </span><span class="kw">char.diff</span>(matrix_binary))</a></code></pre></div>
<pre><code>##   A B C D
## A 0 0 1 1
## B 0 0 1 1
## C 1 1 0 0
## D 1 1 0 0
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>Note that the results is just a pairwise distance (dissimilarity) matrix with some special dual class <code>matrix</code> and <code>char.diff</code>.
This means it can easily be plotted via the disparity package:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" data-line-number="1"><span class="co">## Visualising the matrix</span></a>
<a class="sourceLine" id="cb423-2" data-line-number="2"><span class="kw">plot</span>(differences)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>You can check all the numerous plotting options in the <code>?plot.char.diff</code> manual (it won’t be developed here).</p>
<p>The <code>char.diff</code> function has much more options however (see all of them in the <code>?char.diff</code> manual) for example to measure different differences (via <code>method</code>) or making the comparison work per row (for a distance matrix between the rows):</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" data-line-number="1"><span class="co">## Euclidean distance between rows</span></a>
<a class="sourceLine" id="cb424-2" data-line-number="2"><span class="kw">char.diff</span>(matrix_binary, <span class="dt">by.col =</span> <span class="ot">FALSE</span>, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>)</a></code></pre></div>
<pre><code>##          a        b        c
## a 0.000000 1.414214 1.414214
## b 1.414214 0.000000 0.000000
## c 1.414214 0.000000 0.000000
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>We can however make it more interesting by playing with the different rules to play with different tokens.
First let’s create a matrix with morphological characters as numeric <code>character</code>s:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" data-line-number="1"><span class="co">## A random character matrix</span></a>
<a class="sourceLine" id="cb426-2" data-line-number="2">(matrix_character &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>), <span class="dv">30</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">ncol =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb426-3" data-line-number="3">                           <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])))</a></code></pre></div>
<pre><code>##   A   B   C   D   E  
## a &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot;
## b &quot;0&quot; &quot;2&quot; &quot;0&quot; &quot;2&quot; &quot;0&quot;
## c &quot;2&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;0&quot;
## d &quot;1&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot;
## e &quot;2&quot; &quot;2&quot; &quot;1&quot; &quot;1&quot; &quot;2&quot;
## f &quot;0&quot; &quot;2&quot; &quot;0&quot; &quot;2&quot; &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" data-line-number="1"><span class="co">## The hamming difference between columns</span></a>
<a class="sourceLine" id="cb428-2" data-line-number="2"><span class="kw">char.diff</span>(matrix_character)</a></code></pre></div>
<pre><code>##     A   B   C   D   E
## A 0.0 0.6 0.6 0.6 0.8
## B 0.6 0.0 0.4 0.4 0.8
## C 0.6 0.4 0.0 0.4 0.6
## D 0.6 0.4 0.4 0.0 1.0
## E 0.8 0.8 0.6 1.0 0.0
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>Here the characters are automatically converted into bitwise integers to be compared efficiently. We can now add some more special tokens like <code>&quot;?&quot;</code> or <code>&quot;0/1&quot;</code> for uncertainties between state <code>&quot;0&quot;</code> and <code>&quot;1&quot;</code> but not <code>&quot;2&quot;</code>:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" data-line-number="1"><span class="co">## Adding uncertain characters</span></a>
<a class="sourceLine" id="cb430-2" data-line-number="2">matrix_character[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dv">8</span>)] &lt;-<span class="st"> &quot;0/1&quot;</span></a>
<a class="sourceLine" id="cb430-3" data-line-number="3"></a>
<a class="sourceLine" id="cb430-4" data-line-number="4"><span class="co">## Adding missing data</span></a>
<a class="sourceLine" id="cb430-5" data-line-number="5">(matrix_character[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dv">5</span>)] &lt;-<span class="st"> &quot;?&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;?&quot;</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" data-line-number="1"><span class="co">## The hamming difference between columns including the special characters</span></a>
<a class="sourceLine" id="cb432-2" data-line-number="2"><span class="kw">char.diff</span>(matrix_character)</a></code></pre></div>
<pre><code>##           A         B    C    D         E
## A 0.0000000 0.6666667 1.00 0.50 0.6666667
## B 0.6666667 0.0000000 1.00 1.00 0.7500000
## C 1.0000000 1.0000000 0.00 0.00 0.2500000
## D 0.5000000 1.0000000 0.00 0.00 0.2500000
## E 0.6666667 0.7500000 0.25 0.25 0.0000000
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>Note here that it detected the default behaviours for the special tokens <code>&quot;?&quot;</code> and <code>&quot;/&quot;</code>: <code>&quot;?&quot;</code> are treated as <code>NA</code> (not compared) and <code>&quot;/&quot;</code> are treated as both states (e.g. <code>&quot;0/1&quot;</code> is treated as <code>&quot;0&quot;</code> and as <code>&quot;1&quot;</code>).
We can specify both the special tokens and the special behaviours to consider via <code>special.tokens</code> and <code>special.behaviours</code>.
The <code>special.tokens</code> are <code>missing = &quot;?&quot;</code>, <code>inapplicable = &quot;-&quot;</code>, <code>uncertainty = &quot;\&quot;</code> and <code>polymorphism = &quot;&amp;&quot;</code> meaning we don’t have to modify them for now.
However, say we want to change the behaviour for <code>&quot;?&quot;</code> and treat them as all possible characters and treat <code>&quot;/&quot;</code> as only the character <code>&quot;0&quot;</code> (as an integer) we can specify them giving a behaviour function:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" data-line-number="1"><span class="co">## Specifying some special behaviours</span></a>
<a class="sourceLine" id="cb434-2" data-line-number="2">my_special_behaviours &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">missing =</span> <span class="cf">function</span>(x,y) <span class="kw">return</span>(y),</a>
<a class="sourceLine" id="cb434-3" data-line-number="3">                              <span class="dt">uncertainty =</span> <span class="cf">function</span>(x,y) <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb434-4" data-line-number="4"></a>
<a class="sourceLine" id="cb434-5" data-line-number="5"><span class="co">## Passing these special behaviours to the char.diff function</span></a>
<a class="sourceLine" id="cb434-6" data-line-number="6"><span class="kw">char.diff</span>(matrix_character, <span class="dt">special.behaviour =</span> my_special_behaviours)</a></code></pre></div>
<pre><code>##     A   B   C   D   E
## A 0.0 0.6 0.6 0.6 0.6
## B 0.6 0.0 0.8 0.8 0.8
## C 0.6 0.8 0.0 0.4 0.6
## D 0.6 0.8 0.4 0.0 1.0
## E 0.6 0.8 0.6 1.0 0.0
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>The results are quiet different as before! Note that you can also specify some really specific behaviours for any type of special token.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" data-line-number="1"><span class="co">## Adding weird tokens to the matrix</span></a>
<a class="sourceLine" id="cb436-2" data-line-number="2">matrix_character[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dv">8</span>)] &lt;-<span class="st"> &quot;%&quot;</span></a>
<a class="sourceLine" id="cb436-3" data-line-number="3"></a>
<a class="sourceLine" id="cb436-4" data-line-number="4"><span class="co">## Specify the new token and the new behaviour</span></a>
<a class="sourceLine" id="cb436-5" data-line-number="5"><span class="kw">char.diff</span>(matrix_character, <span class="dt">special.tokens =</span> <span class="kw">c</span>(<span class="dt">weird_one =</span> <span class="st">&quot;%&quot;</span>),</a>
<a class="sourceLine" id="cb436-6" data-line-number="6">                            <span class="dt">special.behaviours =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb436-7" data-line-number="7">                                <span class="dt">weird_one =</span> <span class="cf">function</span>(x,y) <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="dv">42</span>)))</a>
<a class="sourceLine" id="cb436-8" data-line-number="8">                            )</a></code></pre></div>
<pre><code>##     A   B C D   E
## A   0   1 1 0 NaN
## B   1   0 1 1 NaN
## C   1   1 0 0   0
## D   0   1 0 0   0
## E NaN NaN 0 0   0
## attr(,&quot;class&quot;)
## [1] &quot;matrix&quot;    &quot;char.diff&quot;</code></pre>
<p>Of course the results can be quiet surprising then… But that’s the essence of the modularity. You can see more options in the function manual <code>?char.diff</code>!</p>
</div>
<div id="clean.data" class="section level2">
<h2><span class="header-section-number">6.2</span> <code>clean.data</code></h2>
<p>This is a rather useful function that allows matching a <code>matrix</code> or a <code>data.frame</code> to a tree (<code>phylo</code>) or a distribution of trees (<code>multiPhylo</code>).
This function outputs the cleaned data and trees (if cleaning was needed) and a list of dropped rows and tips.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" data-line-number="1"><span class="co">## Generating a trees with labels from a to e</span></a>
<a class="sourceLine" id="cb438-2" data-line-number="2">dummy_tree &lt;-<span class="st"> </span><span class="kw">rtree</span>(<span class="dv">5</span>, <span class="dt">tip.label =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb438-3" data-line-number="3"></a>
<a class="sourceLine" id="cb438-4" data-line-number="4"><span class="co">## Generating a matrix with rows from b to f</span></a>
<a class="sourceLine" id="cb438-5" data-line-number="5">dummy_data &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(LETTERS[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>], <span class="kw">c</span>(<span class="st">&quot;var1&quot;</span>, <span class="st">&quot;var2&quot;</span>)))</a>
<a class="sourceLine" id="cb438-6" data-line-number="6"></a>
<a class="sourceLine" id="cb438-7" data-line-number="7"><span class="co">##Cleaning the trees and the data</span></a>
<a class="sourceLine" id="cb438-8" data-line-number="8">(cleaned &lt;-<span class="st"> </span><span class="kw">clean.data</span>(<span class="dt">data =</span> dummy_data, <span class="dt">tree =</span> dummy_tree))</a></code></pre></div>
<pre><code>## $tree
## 
## Phylogenetic tree with 4 tips and 3 internal nodes.
## 
## Tip labels:
##   D, B, E, C
## 
## Rooted; includes branch lengths.
## 
## $data
##   var1 var2
## B    1    1
## C    1    1
## D    1    1
## E    1    1
## 
## $dropped_tips
## [1] &quot;A&quot;
## 
## $dropped_rows
## [1] &quot;F&quot;</code></pre>
</div>
<div id="crown.stem" class="section level2">
<h2><span class="header-section-number">6.3</span> <code>crown.stem</code></h2>
<p>This function quiet handily separates tips from a phylogeny between crown members (the living taxa and their descendants) and their stem members (the fossil taxa without any living relatives).</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" data-line-number="1"><span class="kw">data</span>(BeckLee_tree)</a>
<a class="sourceLine" id="cb440-2" data-line-number="2"><span class="co">## Diving both crow and stem species</span></a>
<a class="sourceLine" id="cb440-3" data-line-number="3">(<span class="kw">crown.stem</span>(BeckLee_tree, <span class="dt">inc.nodes =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>## $crown
##  [1] &quot;Dasypodidae&quot;     &quot;Bradypus&quot;        &quot;Myrmecophagidae&quot; &quot;Todralestes&quot;    
##  [5] &quot;Potamogalinae&quot;   &quot;Dilambdogale&quot;    &quot;Widanelfarasia&quot;  &quot;Rhynchocyon&quot;    
##  [9] &quot;Procavia&quot;        &quot;Moeritherium&quot;    &quot;Pezosiren&quot;       &quot;Trichechus&quot;     
## [13] &quot;Tribosphenomys&quot;  &quot;Paramys&quot;         &quot;Rhombomylus&quot;     &quot;Gomphos&quot;        
## [17] &quot;Mimotona&quot;        &quot;Cynocephalus&quot;    &quot;Purgatorius&quot;     &quot;Plesiadapis&quot;    
## [21] &quot;Notharctus&quot;      &quot;Adapis&quot;          &quot;Patriomanis&quot;     &quot;Protictis&quot;      
## [25] &quot;Vulpavus&quot;        &quot;Miacis&quot;          &quot;Icaronycteris&quot;   &quot;Soricidae&quot;      
## [29] &quot;Solenodon&quot;       &quot;Eoryctes&quot;       
## 
## $stem
##  [1] &quot;Daulestes&quot;              &quot;Bulaklestes&quot;            &quot;Uchkudukodon&quot;          
##  [4] &quot;Kennalestes&quot;            &quot;Asioryctes&quot;             &quot;Ukhaatherium&quot;          
##  [7] &quot;Cimolestes&quot;             &quot;unnamed_cimolestid&quot;     &quot;Maelestes&quot;             
## [10] &quot;Batodon&quot;                &quot;Kulbeckia&quot;              &quot;Zhangolestes&quot;          
## [13] &quot;unnamed_zalambdalestid&quot; &quot;Zalambdalestes&quot;         &quot;Barunlestes&quot;           
## [16] &quot;Gypsonictops&quot;           &quot;Leptictis&quot;              &quot;Oxyclaenus&quot;            
## [19] &quot;Protungulatum&quot;          &quot;Oxyprimus&quot;</code></pre>
<p>Note that it is possible to include or exclude nodes from the output.
To see a more applied example: this function is used in <a href="details-of-specific-functions.html#custom-subsets">chapter 03: specific tutorials</a>.</p>
</div>
<div id="get.bin.ages" class="section level2">
<h2><span class="header-section-number">6.4</span> <code>get.bin.ages</code></h2>
<p>This function is similar than the <code>crown.stem</code> one as it is based on a tree but this one outputs the stratigraphic bins ages that the tree is covering.
This can be useful to generate precise bin ages for the <code>chrono.subsets</code> function:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1"><span class="kw">get.bin.ages</span>(BeckLee_tree)</a></code></pre></div>
<pre><code>##  [1] 132.9000 129.4000 125.0000 113.0000 100.5000  93.9000  89.8000  86.3000
##  [9]  83.6000  72.1000  66.0000  61.6000  59.2000  56.0000  47.8000  41.2000
## [17]  37.8000  33.9000  28.1000  23.0300  20.4400  15.9700  13.8200  11.6300
## [25]   7.2460   5.3330   3.6000   2.5800   1.8000   0.7810   0.1260   0.0117
## [33]   0.0000</code></pre>
<p>Note that this function outputs the stratigraphic age limits by default but this can be customisable by specifying the <code>type</code> of data (e.g. <code>type = &quot;Eon&quot;</code> for eons).
The function also intakes several optional arguments such as whether to output the startm end, range or midpoint of the stratigraphy or the year of reference of the International Commission of Stratigraphy.
To see a more applied example: this function is used in <a href="details-of-specific-functions.html#chrono-subsets">chapter 03: specific tutorials</a>.</p>
</div>
<div id="pair.plot" class="section level2">
<h2><span class="header-section-number">6.5</span> <code>pair.plot</code></h2>
<p>This utility function allows to plot a matrix image of pairwise comparisons.
This can be useful when getting pairwise comparisons and if you’d like to see at a glance which pairs of comparisons have high or low values.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1"><span class="co">## Random data</span></a>
<a class="sourceLine" id="cb444-2" data-line-number="2">data &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">runif</span>(<span class="dv">42</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb444-3" data-line-number="3"></a>
<a class="sourceLine" id="cb444-4" data-line-number="4"><span class="co">## Plotting the first column as a pairwise comparisons</span></a>
<a class="sourceLine" id="cb444-5" data-line-number="5"><span class="kw">pair.plot</span>(data, <span class="dt">what =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">diag =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>Here blue squares are ones that have a high value and orange ones the ones that have low values.
Note that the values plotted correspond the first column of the data as designated by <code>what = 1</code>.</p>
<p>It is also possible to add some tokens or symbols to quickly highlight to specific cells, for example which elements in the data are below a certain value:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1"><span class="co">## The same plot as before without the diagonal being the maximal observed value</span></a>
<a class="sourceLine" id="cb445-2" data-line-number="2"><span class="kw">pair.plot</span>(data, <span class="dt">what =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">diag =</span> <span class="st">&quot;max&quot;</span>)</a>
<a class="sourceLine" id="cb445-3" data-line-number="3"><span class="co">## Highlighting with an asterisk which squares have a value below 0.2</span></a>
<a class="sourceLine" id="cb445-4" data-line-number="4"><span class="kw">pair.plot</span>(data, <span class="dt">what =</span> <span class="dv">1</span>, <span class="dt">binary =</span> <span class="fl">0.2</span>, <span class="dt">add =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>This function can also be used as a binary display when running a series of pairwise t-tests.
For example, the following script runs a wilcoxon test between the time-slices from the <code>disparity</code> example dataset and displays in black which pairs of slices have a p-value below 0.05:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" data-line-number="1"><span class="co">## Loading disparity data</span></a>
<a class="sourceLine" id="cb446-2" data-line-number="2"><span class="kw">data</span>(disparity)</a>
<a class="sourceLine" id="cb446-3" data-line-number="3"></a>
<a class="sourceLine" id="cb446-4" data-line-number="4"><span class="co">## Testing the pairwise difference between slices</span></a>
<a class="sourceLine" id="cb446-5" data-line-number="5">tests &lt;-<span class="st"> </span><span class="kw">test.dispRity</span>(disparity, <span class="dt">test =</span> wilcox.test, <span class="dt">correction =</span> <span class="st">&quot;bonferroni&quot;</span>)</a>
<a class="sourceLine" id="cb446-6" data-line-number="6"></a>
<a class="sourceLine" id="cb446-7" data-line-number="7"><span class="co">## Plotting the significance</span></a>
<a class="sourceLine" id="cb446-8" data-line-number="8"><span class="kw">pair.plot</span>(<span class="kw">as.data.frame</span>(tests), <span class="dt">what =</span> <span class="st">&quot;p.value&quot;</span>, <span class="dt">binary =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="reduce.matrix" class="section level2">
<h2><span class="header-section-number">6.6</span> <code>reduce.matrix</code></h2>
<p>This function allows to reduce columns or rows of a matrix to make sure that there is enough overlap for further analysis.
This is particularly useful if you are going to use distance matrices since it uses the <code>vegan::vegdist</code> function to test whether distances can be calculated or not.</p>
<p>For example, if we have a patchy matrix like so (where the black squares represent available data):</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb447-2" data-line-number="2"><span class="co">## A 10*5 matrix</span></a>
<a class="sourceLine" id="cb447-3" data-line-number="3">na_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>), <span class="dv">10</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb447-4" data-line-number="4"><span class="co">## Making sure some rows don&#39;t overlap</span></a>
<a class="sourceLine" id="cb447-5" data-line-number="5">na_matrix[<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb447-6" data-line-number="6">na_matrix[<span class="dv">2</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb447-7" data-line-number="7"><span class="co">## Adding 50% NAs</span></a>
<a class="sourceLine" id="cb447-8" data-line-number="8">na_matrix[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">25</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb447-9" data-line-number="9"><span class="co">## Illustrating the gappy matrix</span></a>
<a class="sourceLine" id="cb447-10" data-line-number="10"><span class="kw">image</span>(<span class="kw">t</span>(na_matrix), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>We can use the <code>reduce.matrix</code> to double check whether any rows cannot be compared.
The functions needs as an input the type of distance that will be used, say a <code>&quot;gower&quot;</code> distance:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" data-line-number="1"><span class="co">## Reducing the matrix by row</span></a>
<a class="sourceLine" id="cb448-2" data-line-number="2">(reduction &lt;-<span class="st"> </span><span class="kw">reduce.matrix</span>(na_matrix, <span class="dt">distance =</span> <span class="st">&quot;gower&quot;</span>))</a></code></pre></div>
<pre><code>## $rows.to.remove
## [1] &quot;9&quot; &quot;1&quot;
## 
## $cols.to.remove
## NULL</code></pre>
<p>We can not remove the rows 1 and 9 and see if that improved the overlap:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" data-line-number="1"><span class="kw">image</span>(<span class="kw">t</span>(na_matrix[<span class="op">-</span><span class="kw">as.numeric</span>(reduction<span class="op">$</span>rows.to.remove), ]), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
<div id="slice.tree" class="section level2">
<h2><span class="header-section-number">6.7</span> <code>slice.tree</code></h2>
<p>This function is a modification of the <code>paleotree::timeSliceTree</code> function that allows to make slices through a phylogenetic tree.
Compared to the <code>paleotree::timeSliceTree</code>, this function allows a model to decide which tip or node to use when slicing through a branch (whereas <code>paleotree::timeSliceTree</code> always choose the first available tip alphabetically).
The models for choosing which tip or node are the same as the ones used in the <code>chrono.subsets</code> and are described in <a href="details-of-specific-functions.html#chrono-subsets">chapter 03: specific tutorials</a>.</p>
<p>The function works by using at least a tree, a slice age and a model:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb451-2" data-line-number="2"><span class="co">## Generate a random ultrametric tree</span></a>
<a class="sourceLine" id="cb451-3" data-line-number="3">tree &lt;-<span class="st"> </span><span class="kw">rcoal</span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb451-4" data-line-number="4"><span class="co">## Add some node labels</span></a>
<a class="sourceLine" id="cb451-5" data-line-number="5">tree<span class="op">$</span>node.label &lt;-<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>]</a>
<a class="sourceLine" id="cb451-6" data-line-number="6"><span class="co">## Add its root time</span></a>
<a class="sourceLine" id="cb451-7" data-line-number="7">tree<span class="op">$</span>root.time &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">tree.age</span>(tree)<span class="op">$</span>ages)</a>
<a class="sourceLine" id="cb451-8" data-line-number="8"></a>
<a class="sourceLine" id="cb451-9" data-line-number="9"><span class="co">## Slicing the tree at age 0.75</span></a>
<a class="sourceLine" id="cb451-10" data-line-number="10">tree_<span class="dv">75</span> &lt;-<span class="st"> </span><span class="kw">slice.tree</span>(tree, <span class="dt">age =</span> <span class="fl">0.75</span>, <span class="st">&quot;acctran&quot;</span>)</a>
<a class="sourceLine" id="cb451-11" data-line-number="11"></a>
<a class="sourceLine" id="cb451-12" data-line-number="12"><span class="co">## Showing both trees</span></a>
<a class="sourceLine" id="cb451-13" data-line-number="13"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb451-14" data-line-number="14"><span class="kw">plot</span>(tree, <span class="dt">main =</span> <span class="st">&quot;original tree&quot;</span>)</a>
<a class="sourceLine" id="cb451-15" data-line-number="15"><span class="kw">axisPhylo</span>() ; <span class="kw">nodelabels</span>(tree<span class="op">$</span>node.label, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb451-16" data-line-number="16"><span class="kw">abline</span>(<span class="dt">v =</span> (<span class="kw">max</span>(<span class="kw">tree.age</span>(tree)<span class="op">$</span>ages) <span class="op">-</span><span class="st"> </span><span class="fl">0.75</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb451-17" data-line-number="17"><span class="kw">plot</span>(tree_<span class="dv">75</span>, <span class="dt">main =</span> <span class="st">&quot;sliced tree&quot;</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
</div>
<div id="slide.nodes-and-remove.zero.brlen" class="section level2">
<h2><span class="header-section-number">6.8</span> <code>slide.nodes</code> and <code>remove.zero.brlen</code></h2>
<p>This function allows to slide nodes along a tree!
In other words it allows to change the branch length leading to a node without modifying the overall tree shape.
This can be useful to add some value to 0 branch lengths for example.</p>
<p>The function works by taking a node (or a list of nodes), a tree and a sliding value.
The node will be moved “up” (towards the tips) for the given sliding value.
You can move the node “down” (towards the roots) using a negative value.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb452-2" data-line-number="2"><span class="co">## Generating simple coalescent tree</span></a>
<a class="sourceLine" id="cb452-3" data-line-number="3">tree &lt;-<span class="st"> </span><span class="kw">rcoal</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb452-4" data-line-number="4"></a>
<a class="sourceLine" id="cb452-5" data-line-number="5"><span class="co">## Sliding node 8 up and down</span></a>
<a class="sourceLine" id="cb452-6" data-line-number="6">tree_slide_up &lt;-<span class="st"> </span><span class="kw">slide.nodes</span>(<span class="dv">8</span>, tree, <span class="dt">slide =</span> <span class="fl">0.075</span>)</a>
<a class="sourceLine" id="cb452-7" data-line-number="7">tree_slide_down &lt;-<span class="st"> </span><span class="kw">slide.nodes</span>(<span class="dv">8</span>, tree, <span class="dt">slide =</span> <span class="fl">-0.075</span>)</a>
<a class="sourceLine" id="cb452-8" data-line-number="8"></a>
<a class="sourceLine" id="cb452-9" data-line-number="9"><span class="co">## Display the results</span></a>
<a class="sourceLine" id="cb452-10" data-line-number="10"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb452-11" data-line-number="11"><span class="kw">plot</span>(tree, <span class="dt">main =</span> <span class="st">&quot;original tree&quot;</span>) ; <span class="kw">axisPhylo</span>() ; <span class="kw">nodelabels</span>()</a>
<a class="sourceLine" id="cb452-12" data-line-number="12"><span class="kw">plot</span>(tree_slide_up, <span class="dt">main =</span> <span class="st">&quot;slide up!&quot;</span>) ; <span class="kw">axisPhylo</span>() ; <span class="kw">nodelabels</span>()</a>
<a class="sourceLine" id="cb452-13" data-line-number="13"><span class="kw">plot</span>(tree_slide_down, <span class="dt">main =</span> <span class="st">&quot;slide down!&quot;</span>) ; <span class="kw">axisPhylo</span>() ; <span class="kw">nodelabels</span>()</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>The <code>remove.zero.brlen</code> is a “clever” wrapping function that uses the <code>slide.nodes</code> function to stochastically remove zero branch lengths across a whole tree.
This function will slide nodes up or down in successive postorder traversals (i.e. going down the tree clade by clade) in order to minimise the number of nodes to slide while making sure there are no silly negative branch lengths produced!
By default it is trying to slide the nodes using 1% of the minimum branch length to avoid changing the topology too much.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb453-2" data-line-number="2"><span class="co">## Generating a tree</span></a>
<a class="sourceLine" id="cb453-3" data-line-number="3">tree &lt;-<span class="st"> </span><span class="kw">rtree</span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb453-4" data-line-number="4"></a>
<a class="sourceLine" id="cb453-5" data-line-number="5"><span class="co">## Adding some zero branch lengths (5)</span></a>
<a class="sourceLine" id="cb453-6" data-line-number="6">tree<span class="op">$</span>edge.length[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">Nedge</span>(tree), <span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb453-7" data-line-number="7"></a>
<a class="sourceLine" id="cb453-8" data-line-number="8"><span class="co">## And now removing these zero branch lengths!</span></a>
<a class="sourceLine" id="cb453-9" data-line-number="9">tree_no_zero &lt;-<span class="st"> </span><span class="kw">remove.zero.brlen</span>(tree)</a>
<a class="sourceLine" id="cb453-10" data-line-number="10"></a>
<a class="sourceLine" id="cb453-11" data-line-number="11"><span class="co">## Exaggerating the removal (to make it visible)</span></a>
<a class="sourceLine" id="cb453-12" data-line-number="12">tree_exaggerated &lt;-<span class="st"> </span><span class="kw">remove.zero.brlen</span>(tree, <span class="dt">slide =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb453-13" data-line-number="13"></a>
<a class="sourceLine" id="cb453-14" data-line-number="14"><span class="co">## Check the differences</span></a>
<a class="sourceLine" id="cb453-15" data-line-number="15"><span class="kw">any</span>(tree<span class="op">$</span>edge.length <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="kw">any</span>(tree_no_zero<span class="op">$</span>edge.length <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="kw">any</span>(tree_exaggerated<span class="op">$</span>edge.length <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1"><span class="co">## Display the results</span></a>
<a class="sourceLine" id="cb459-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb459-3" data-line-number="3"><span class="kw">plot</span>(tree, <span class="dt">main =</span> <span class="st">&quot;with zero edges&quot;</span>)</a>
<a class="sourceLine" id="cb459-4" data-line-number="4"><span class="kw">plot</span>(tree_no_zero, <span class="dt">main =</span> <span class="st">&quot;without zero edges!&quot;</span>)</a>
<a class="sourceLine" id="cb459-5" data-line-number="5"><span class="kw">plot</span>(tree_exaggerated, <span class="dt">main =</span> <span class="st">&quot;with longer edges&quot;</span>)</a></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
<div id="tree.age" class="section level2">
<h2><span class="header-section-number">6.9</span> <code>tree.age</code></h2>
<p>This function allows to quickly calculate the ages of each tips and nodes present in a tree.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb460-2" data-line-number="2">tree &lt;-<span class="st"> </span><span class="kw">rtree</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb460-3" data-line-number="3"><span class="co">## The tree age from a 10 tip tree</span></a>
<a class="sourceLine" id="cb460-4" data-line-number="4"><span class="kw">tree.age</span>(tree)</a></code></pre></div>
<pre><code>##     ages elements
## 1  0.707       t7
## 2  0.142       t2
## 3  0.000       t3
## 4  1.467       t8
## 5  1.366       t1
## 6  1.895       t5
## 7  1.536       t6
## 8  1.456       t9
## 9  0.815      t10
## 10 2.343       t4
## 11 3.011       11
## 12 2.631       12
## 13 1.854       13
## 14 0.919       14
## 15 0.267       15
## 16 2.618       16
## 17 2.235       17
## 18 2.136       18
## 19 1.642       19</code></pre>
<p>It also allows to set the age of the root of the tree:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" data-line-number="1"><span class="co">## The ages starting from -100 units</span></a>
<a class="sourceLine" id="cb462-2" data-line-number="2"><span class="kw">tree.age</span>(tree, <span class="dt">age =</span> <span class="dv">100</span>)</a></code></pre></div>
<pre><code>##       ages elements
## 1   23.472       t7
## 2    4.705       t2
## 3    0.000       t3
## 4   48.736       t8
## 5   45.352       t1
## 6   62.931       t5
## 7   51.012       t6
## 8   48.349       t9
## 9   27.055      t10
## 10  77.800       t4
## 11 100.000       11
## 12  87.379       12
## 13  61.559       13
## 14  30.517       14
## 15   8.875       15
## 16  86.934       16
## 17  74.235       17
## 18  70.924       18
## 19  54.533       19</code></pre>
<p>Usually tree age is calculated from the present to the past (e.g. in million years ago) but it is possible to reverse it using the <code>order = present</code> option:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" data-line-number="1"><span class="co">## The ages in terms of tip/node height</span></a>
<a class="sourceLine" id="cb464-2" data-line-number="2"><span class="kw">tree.age</span>(tree, <span class="dt">order =</span> <span class="st">&quot;present&quot;</span>)</a></code></pre></div>
<pre><code>##     ages elements
## 1  2.304       t7
## 2  2.869       t2
## 3  3.011       t3
## 4  1.544       t8
## 5  1.646       t1
## 6  1.116       t5
## 7  1.475       t6
## 8  1.555       t9
## 9  2.196      t10
## 10 0.668       t4
## 11 0.000       11
## 12 0.380       12
## 13 1.157       13
## 14 2.092       14
## 15 2.744       15
## 16 0.393       16
## 17 0.776       17
## 18 0.876       18
## 19 1.369       19</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="making-stuff-up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-guts-of-the-disprity-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/dispRity/inst/gitbook/edit/master/05_other-functionalities.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
